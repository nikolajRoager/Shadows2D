THIS VERSION IS LITERALLY CURSED, THERE IS UNDEFINED BEHAVIOR SOMEWHERE AND IT BEHAVES COMPLETELY RANDOMLY.

IT LITERALLY CAN'T BE FIXED.
